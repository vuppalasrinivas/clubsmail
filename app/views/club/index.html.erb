<%#=@club%>
<%@test = ["vizag central", "cmr central", "simhachalam", "visakhapatnam airport"]%>

<script src="//maps.google.com/maps/api/js?v=3.18&sensor=false&client=&key=&libraries=geometry&language=&hl=&region="></script> 
<script src="//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js' type='text/javascript'></script> 

<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>



<script>
var geocoder = new google.maps.Geocoder();

var latitude = [] ;
var longitude = [];
var clubsaddress =[];

clubcount = '<%= raw @club.length %>';
<% @club.each do |u| %>
  
  clubsaddress = '<%=u%>';
  //clubsaddress = clubsaddress.replace(/nº/g , "");
  clubsaddress = clubsaddress.substring(0,clubsaddress.indexOf("nº"));
 //alert(clubsaddress);
geocoder.geocode( { 'address': clubsaddress}, function(results, status) {
  
  if (status == google.maps.GeocoderStatus.OK) {
  
    latitude1 =  results[0].geometry.location.lat();
    longitude1 = results[0].geometry.location.lng();
    latitude.push(latitude1);
    longitude.push(longitude1);
    //alert(latitude);
  } 
});
<% end %>
handler = Gmaps.build('Google');

handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
  
  for(i=0; i<latitude.length; i++)
  {
   //alert(latitude.length);
  markers = handler.addMarkers([
    {
      "lat": latitude[i],
      "lng": longitude[i],
      "picture": {
        //"url": "http://people.mozilla.com/~faaborg/files/shiretoko/firefoxIcon/firefox-32.png",
        "width":  32,
        "height": 32
      },
      //"infowindow": "hello!"
    }

  ]);
 }
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
  handler.getMap().setZoom(14);
});



</script>



  
